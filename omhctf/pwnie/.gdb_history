x/gx &__free_hook 
b __free_hook
b *&__free_hook
b *0x00007f3cfc0053d5
c
q
p __libc_atexit
p _libc_atexit
p libc_atexit
p 
function 
p _exit 
p &_exit 
p/i &_exit 
vmmap 0x7f81933e9dd0
disassemble _exit 
p _rtld_global
p *_rtld_global
p &_rtld_global
p *&_rtld_global
q
vmmap
p _rtld_global
p &_rtld_global
vmmap 0x7f4e12d3a060
vmmap
p &_rtld_global._rtld_lock_lock_recursive
p &_rtld_global._dl_rtld_lock_recursive 
vmmap &_rtld_global._dl_rtld_lock_recursive 
vmmap
q
b printf
c
stack 10
c
vmmap 0x7f6136c26007
q
nextcall 
finish 
finish 
ni
vmmap 0x7ffff66f1fa0
vmmap 0x7fb2baf47710
vmmap 0x7fb2baae0007
vmmap
q
nextcall printf
q
q
b exit
c
vmmap
x/gx 0x7ffff7ffdf60
ni
si
ni
si
si
ni
si
si
vmmap 0x7ffff7dcb738
si
si
q
vmmap
b exit
c
q
nextcall 
finish 
finish 
ni
vmmap 0x7ffff7ffe710
vmmap
vmmap 0x7ffff7b97007
distance 0x7ffff7b97007 0x7ffff7a23000
q
nextcall 
finish 
ni
distance 0x7fffffffebd8 0x7fffffffebb0
q
p __libc_atexit
b exit
c
s
s
p __exit_funcs
p *__exit_funcs
vmmap 0x7ffff7dd3d80
p &__exit_funcs
x/gx &__exit_funcs
p &__exit_funcs
vmmap 0x00007ffff7dd3d80
x/gx __exit_funcs->id
p __exit_funcs->id
p (*__exit_funcs)->id
p (*__exit_funcs)->idx
p (__exit_funcs)->idx
set (__exit_funcs)->idx=1
p (__exit_funcs)->idx
p (*__exit_funcs)
p (*__exit_funcs)->fns[0].flavor=2
p (*__exit_funcs)
p (*__exit_funcs)->fns[0].func.on.fn=0x7ffff7b01ed2
p (*__exit_funcs)
n
c
c
c
q
i b
b exit
c
p __exit_funcs
p *__exit_funcs
set (__exit_funcs)->idx=1
p *__exit_funcs
set (__exit_funcs)->fns[0].flavor=2
p *__exit_funcs
(*__exit_funcs)->fns[0].func.on.fn=0x7ffff7b01ed2
set (__exit_funcs)->fns[0].func.on.fn=0x7ffff7b01ed2
p *__exit_funcs
s
s
s
n
p f
n
p onfct 
n
ni
p *__exit_funcs
q
b exit
c
set (__exit_funcs)->idx=1
set (__exit_funcs)->next=1
p * __exit_funcs
b free
c
n
n
n
p hook
ni
si
ni
ni
c
q
b exit
c
p (__exit_funcs)->idx
p &(__exit_funcs)->idx
vmmap 0x7ffff7dd3d88
vmmap
p &(__exit_funcs)->next 
distance 0x7ffff7dd3d80 0x7ffff7a23000
q
b exit
c
q
b exit
b free
c
p hook
n
n
p hook
n
c
c
q
b exit
c
vmmap
distance 0x7ffff7de01ef 0x7ffff79e4000
q
b exit
c
vmmap
x/10i 0x7ffff7aee41c
p __exit_funcs
bt
c
dis 0x000055555555453e
dis 0x000055555555453e 10
disassemble 0x000055555555453e 10
disassemble 0x000055555555453e,10
disassemble 0x000055555555453e +10
disassemble 0x000055555555453e10
disassemble 
help disassemble 
disassemble /m 0x000055555555453e10, +10
disassemble /m 0x000055555555453e10, +100
bt
vmmap
bt
context
vmmap 0x7ffff7d94d80
x/gx 0x7ffff7d94d80
vmmap
q
b exit
c
bt
vmmap
vmmap 0x7ffff7d94d80
x/gx 0x7ffff7d94d80
q
vmmap
p __exit_funcs
q
nextcall 
finish 
finish 
ni
p __free_hook 
ni
bt
bt
q
nextcall 
finish 
finish 
ni
vmmap
p __free_hook 
p &__free_hook 
ni
ni
q
nextcall 
finish 
finish 
vmmap
ni
vmmap
distance 0x7ffff7dde39f 0x7ffff79e2000
ni
si
si
ni
vmmap 0x7ffff7a24ff0
x/gx 0x7ffff7a24ff0
vmmap 0x7ffff7dcd718
x/gx 0x7ffff7dcd718
vmmap 0x00007ffff7dced80
x/gx 0x00007ffff7dced80
distance 0x00007ffff7dced80
vmmap
distance 0x00007ffff7dced80 0x7ffff79e2000
q
q
